$(function(){function j(a){a=a.find("a.label");if(a.length==0)return"";return a.attr("rel")}function f(a){e&&e.length>0&&e.removeClass("current");e=a;if(e.length>0){k=e.attr("id");e.addClass("current");g.show().html(e.find("p").children().clone());var a=g.height(),c=h.height();c<a&&h.css("min-height",a);var b=e.position();if(b){var d=0;b.top>0&&(d=Math.round(b.top/c*100));a=b.top-d/120*a;a=Math.max(0,a);g.stop().animate({top:a})}}else g.hide()}function l(){var a,c,b=$("#admin_menu"),d={path:gpBLink+
"/Admin_Menu",expires:100};if(b.length>0){a=n("gp_menu_hide")||"";a=decodeURIComponent(a);var e=$("#gp_curr_menu").val();a=a.replace(RegExp("#"+e+"=\\[[^#=\\]\\[]*\\]",""),"");c="#"+$("#gp_curr_menu").val()+"=[";b.find(".hidechildren > div > .label").each(function(a,b){c+=b.rel+","});c+="]";$.cookie("gp_menu_hide",a+c,d)}$.cookie("gp_menu_prefs",$("#gp_menu_select_form").serialize(),d)}function m(){var a,c,b="";$(".menu_marker").each(function(d,e){c=e.nextSibling.id;a=$(e).children();b+="&menus["+
c+"]="+encodeURIComponent(a.eq(0).val());b+="&menuh["+c+"]="+encodeURIComponent(a.eq(1).val());b+="&menuc["+c+"]="+encodeURIComponent(a.eq(2).val())});return b}function n(a){a+="=";for(var c=document.cookie.split(";"),b=0;b<c.length;b++){for(var d=c[b];d.charAt(0)==" ";)d=d.substring(1,d.length);if(d.indexOf(a)==0)return d.substring(a.length,d.length)}return!1}var h=$("#admin_menu"),g=$("#admin_menu_tools"),e=!1,k=!1,i=!1;h.nestedSortable({disableNesting:"no-nest",forcePlaceholderSize:!0,handle:"div",
items:"li",opacity:0.8,placeholder:"placeholder",tabSize:25,toleranceElement:"> div",listType:"ul",delay:2,stop:function(a,c){var b=c.item,d=b.parent().siblings("div"),e=b.children("div"),b={cmd:"drag",drag_key:j(e),parent:j(d),prev:j(b.prev().children("div")),hidden:b.closest("#menu_available_list").length};d.length>0&&d.parent(":not(.haschildren)").addClass("haschildren");i.length>0&&i.find("li").length==0&&i.removeClass("haschildren");f(e);loading();b=jQuery.param(b,!0);b+=m();$gp.postC(window.location.href,
b)},start:function(a,c){i=c.item.parent().siblings("div").parent()}}).disableSelection();gpresponse.gp_menu_refresh=function(){h.nestedSortable("refresh");if(k){var a=$("#"+k);f(a)}};gplinks.menu_info=function(a,c){c.preventDefault();var b=$(this).parent();window.setTimeout(function(){f(b)},100)};gplinks.expand_img=function(a,c){gplinks.menu_info.call(this,a,c);$li=$(this).closest("li");$li.hasClass("haschildren")&&($li.toggleClass("hidechildren"),l())};gpresponse.replacemenu=function(a){$(a.SELECTOR).find("ul:first").replaceWith(a.CONTENT)};
gpinputs.menupost=function(){var a=m(),c=$(this).closest("form");c.attr("action",jPrep(c.attr("action"),a));$gp.post(this);return!1};gplinks.menupost=function(a,c){c.preventDefault();var b=strip_to(this.search,"?");b+=m();$gp.postC(this.href,b)};$("#gp_menu_select").change(function(){l();window.location=strip_from(window.location.href,"?")});$("input:checkbox").live("click",function(){$this=$(this);$this.filter(":checked").length>0?$this.parent().addClass("gpui-state-checked"):$this.parent().removeClass("gpui-state-checked")});
(function(){var a=$("#admin_menu").find("div:first");f(a);l()})()});